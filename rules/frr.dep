
SPATH       := $($(FRR)_SRC_PATH)
DEP_FILES   := $(SONIC_COMMON_FILES_LIST) rules/frr.mk rules/frr.dep
DEP_FILES   += $(SONIC_COMMON_BASE_FILES_LIST)
DEP_FILES   += $(addprefix $(SPATH)/,$(shell cd $(SPATH) && git ls-files |grep -Ev '^frr$$$$'))

# Account for source files under the frr submodule directory as well.
# The directories under frr submodule directory need to be filtered out because
# the checksum cannot be generated against directories
FRR_SPATH   := $(SPATH)/frr
# Use find to search the type 'file' with git ls-files under FRR_SPATH
# to enumerate those managed by git
SMDEP_FILES := $(addprefix $(FRR_SPATH)/,$(shell cd $(FRR_SPATH) &&  \
			find . -type f -exec git ls-files '''{}''' ';' \
			))
# Use find to search the type 'symbolic to file' with git ls-files under FRR_SPATH
# to enumerate those managed by git
SMDEP_FILES += $(addprefix $(FRR_SPATH)/,$(shell cd $(FRR_SPATH) && \
			find . -xtype f -exec test -h '''{}''' ';' -exec git ls-files '''{}''' ';' \
			))

$(FRR)_CACHE_MODE  := GIT_CONTENT_SHA
$(FRR)_DEP_FLAGS   := $(SONIC_COMMON_FLAGS_LIST)
$(FRR)_DEP_FILES   := $(DEP_FILES)
$(FRR)_SMDEP_FILES := $(SMDEP_FILES)
$(FRR)_SMDEP_PATHS := $(FRR_SPATH)
