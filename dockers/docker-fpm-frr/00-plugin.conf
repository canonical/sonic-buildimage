## omprog test

template(name="prog_msg" type="list") {
     property(name="timegenerated" dateFormat="rfc3339" caseConversion="lower")
         constant(value=";")
     property(name="msg")
     constant(value="\n")
     }

$ModLoad omprog

if ($programname startswith "bgpcfgd") then {
    action(type="omprog"
        binary="/usr/share/sonic/scripts/rsyslog_plugin.py -p bgpcfgd -d -r /root/try"
        output="/var/log/myplugin.log"
        confirmMessages="on"
        template="prog_msg")
}

if ($programname startswith "bgpd") then {
    action(type="omprog"
        binary="/usr/share/sonic/scripts/rsyslog_plugin.py -p bgpd -d -r /root/try"
        output="/var/log/myplugin.log"
        confirmMessages="on"
        template="prog_msg")
}


