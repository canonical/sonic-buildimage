From 671b158301a7679d318cf176662dfb910a81d3b5 Mon Sep 17 00:00:00 2001
From: Tamer Ahmed <tamer.ahmed@microsoft.com>
Date: Wed, 8 Jan 2020 09:17:54 -0800
Subject: [PATCH 1/3] [SNMP] Stop spamming logs with statfs permission denied
 log message #1668

Signed-off-by: Tamer Ahmed <tamer.ahmed@microsoft.com>
---
 agent/mibgroup/hardware/fsys/fsys_mntctl.c | 2 --
 agent/mibgroup/hardware/fsys/fsys_mntent.c | 4 ----
 2 files changed, 6 deletions(-)

diff --git a/agent/mibgroup/hardware/fsys/fsys_mntctl.c b/agent/mibgroup/hardware/fsys/fsys_mntctl.c
index e7d9a1c..b0752c7 100644
--- a/agent/mibgroup/hardware/fsys/fsys_mntctl.c
+++ b/agent/mibgroup/hardware/fsys/fsys_mntctl.c
@@ -163,8 +163,6 @@ netsnmp_fsys_arch_load( void )
             continue;
 
         if ( statfs( entry->path, &stat_buf ) < 0 ) {
-            snprintf( tmpbuf, sizeof(tmpbuf), "Cannot statfs %s", entry->path );
-            snmp_log_perror( tmpbuf );
             continue;
         }
         entry->units =  stat_buf.f_bsize;
diff --git a/agent/mibgroup/hardware/fsys/fsys_mntent.c b/agent/mibgroup/hardware/fsys/fsys_mntent.c
index 3cdcea1..363ce56 100644
--- a/agent/mibgroup/hardware/fsys/fsys_mntent.c
+++ b/agent/mibgroup/hardware/fsys/fsys_mntent.c
@@ -245,10 +245,6 @@ netsnmp_fsys_arch_load( void )
         if ( NSFS_STATFS( entry->path, &stat_buf ) < 0 )
 #endif
         {
-            tmpbuf = NULL;
-            if (asprintf(&tmpbuf, "Cannot statfs %s", entry->path) >= 0)
-                snmp_log_perror(tmpbuf);
-            free(tmpbuf);
             entry->units = stat_buf.NSFS_SIZE;
             entry->size  = 0;
             entry->used  = 0;
-- 
2.17.1

